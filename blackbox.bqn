âŸ¨DualâŸ© â†â€¢Import "dual.bqn"

# maximize sinx + cos xy with gradient ascent
BlackBox â† {F xâ€¿y:
    (x.Sin @).Add (x.Mul y.Add 2).Cos@
}

# initial conditions close to local minima
x â† Â¯1.59 Dual 1â€¿0
y â† Â¯0.03 Dual 0â€¿1

eps â† 0.1 # positive epsilon = gradient ascent

history â† â†•0

Step â† {F:
    r â† BlackBox xâ€¿y
    history â†© history âˆ¾ 1 â¥Š r.n
    â€¢Show "f âŸ¨x,yâŸ© = f âŸ¨" âˆ¾ (â€¢Repr x.n) âˆ¾ "," âˆ¾ (â€¢Repr y.n) âˆ¾ "âŸ© = " âˆ¾ r.Disp@
    dx â† eps Ã— 0 âŠ‘ r.eps
    dy â† eps Ã— 1 âŠ‘ r.eps
    # â€¢Show "âŸ¨dx, dyâŸ© = âŸ¨" âˆ¾ (â€¢Repr dx) âˆ¾ ", " âˆ¾ (â€¢Repr dy) âˆ¾ "âŸ©"
    x â†© (x.n+dx) Dual x.eps
    y â†© (y.n+dy) Dual y.eps
}

Step âŸ 20@

# â€¢Plot history
mi â† âŒŠÂ´history
ma â† âŒˆÂ´history
{ â€¢Out "." âˆ¾Ëœ " "â¥ŠËœâŒŠ0.5+40 Ã— ğ•© (Ã·â—‹(-âŸœmi)) ma }Â¨ history


